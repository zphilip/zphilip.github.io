<!DOCTYPE html>
<html lang="en-us">

<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  
  <!-- include collecttags -->
  
  





  

  <title>
    
      Expection Maximization &middot; Zhu Philip's AI Journey
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link href="https://fonts.googleapis.com/css?family=East+Sea+Dokdo&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.0/css/all.min.css" rel="stylesheet">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- merge something else -->
  
  <!-- merge something else 
  <link rel="stylesheet" href="/assets/css/post.css" />
  <link rel="stylesheet" href="/assets/css/syntax.css" /> -->
  
  
  <link rel="stylesheet" href="/assets/css/common.css" />
  <script src="/assets/js/categories.js"></script>  
  
  <script defer src="/assets/js/lbox.js"></script>
   

  <!-- MathJax -->
  <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    // Fix <code> tags after MathJax finishes running. This is a
    // hack to overcome a shortcoming of Markdown. Discussion at
    // https://github.com/mojombo/jekyll/issues/199
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  // Autonumbering by mathjax
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script> 

</head>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-89141653-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-89141653-4');
</script>



  <body>

    <link rel="stylesheet" href="/assets/style-3.css">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <div align="center">
          <img src="/assets/profile-pixel.png" class="profilepic pt-3 pb-2">
        </div>
        <!-- <a href="/"> -->
          Zhu Philip's AI Journey
        </a>
      </h1>
      <p class="lead"></p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      <!-- Manual set order -->
      <a class="sidebar-nav-item" href="/categories">Categories</a>
      <a class="sidebar-nav-item" href="/working">Working</a>
      <a class="sidebar-nav-item" href="/publication">Publication</a>
      <!-- <a class="sidebar-nav-item" href="/projects">Projects</a> -->
      <a class="sidebar-nav-item" href="/about">About</a>

      <!-- Uncomment for auto order -->
      <!-- 

      
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
          
        
      
        
      
        
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/categories/">Categories</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/publication/">publications</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/working/">Working</a>
          
        
      
        
          
        
      
        
      
        
          
        
      
        
          
        
       -->

      
      <!-- <a class="sidebar-nav-item" href="https://github.com/zphilip/zphilip.github.io">GitHub project</a> -->
      <!-- <span class="sidebar-nav-item">Currently v</span> -->
      
<div id="social-media">
    
    
        
        
            <a href="mailto:zphilip48@gmail.com" title="Email"><i class="fa fa-envelope"></i></a>
        
    
        
        
            <a href="https://www.linkedin.com/in/tianda-zhu-37a5b031" title="Linkedin"><i class="fab fa-linkedin"></i></a>
        
    
        
        
            <a href="https://github.com/zphilip" title="GitHub"><i class="fab fa-github"></i></a>
        
    
        
        
            <a href="https://www.youtube.com/user/zphilip" title="YouTube"><i class="fab fa-youtube"></i></a>
        
    
</div>


    </nav>

    <p>&copy; 2024. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Expection Maximization</h1>
  <span class="post-date">26 Jan 2023</span>
  <font size="6">Expection Maximization</font>
<font size="3">
1, radomly pick the distribution to have the $\mu, \Sigma, \pi (each cluster possibility)$  
2, (E step)get the each given data for each cluter $p(z=j|x_i)$ , using beyasian rule to $p(z=j|x_i) = \frac {p(z=j,x_i)}{p(x_i)}$  
3, (M step)update the $\mu, \Sigma, \pi $ using the calcuated $p(z=j|x_i)$ to weight each data  
4, repeat E-step
 </font>

<h1 id="example-1">Example 1</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>                              <span class="c1"># import numpy
</span><span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">inv</span>                    <span class="c1"># for matrix inverse
</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>                 <span class="c1"># import matplotlib.pyplot for plotting framework
</span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">multivariate_normal</span>     <span class="c1"># for generating pdf
</span></code></pre></div></div>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/1adb4bc2-0938-47e2-952f-14d0bfb7c37a.png" alt="image.png" /></p>

<p>EM in GMM is to learn the parameters above. 
\(p(x,z) = p(z)p(x|z)
=\pi N(x|\mu_z,\Sigma_z)\)</p>

<ul>
  <li>$\pi$ is probility of chooing cluster z</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>$x</td>
          <td>z$ has distribution $N(x</td>
          <td>\mu_z,\Sigma_z)$</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>$z$ corresponding to x is the true cluster assigement</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">m1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>      <span class="c1"># consider a random mean and covariance value
</span><span class="n">m2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>                                              
<span class="n">cov1</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>                                      
<span class="n">cov2</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">cov1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,))</span>  <span class="c1"># Generating 200 samples for each mean and covariance
</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">cov2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,))</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>                                 
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">)</span>     
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>                                  
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'X-Axis'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>              
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Y-Axis'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>                     
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Ground Truth'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>    
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>            
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_5_0.png" alt="png" /></p>

<p>get the inital distribution from data
<img src="/assets/2023-10-11-expectation-maximization-algorithm_files/4c0e15ec-652f-4361-a9fe-ac1fb5719257.png" alt="image.png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">random</span>

<span class="n">m1</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">cov1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">cov</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="n">cov2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">cov</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="n">pi</span> <span class="o">=</span> <span class="mf">0.5</span>
</code></pre></div></div>

<p>random sampling the  (m1,conv1) and (m2, conv2) distribution</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>  
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span> 

<span class="n">Z1</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">cov1</span><span class="p">)</span>  
<span class="n">Z2</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">cov2</span><span class="p">)</span>

<span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">empty</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="p">,))</span>                <span class="c1"># a new array of given shape and type, without initializing entries
</span><span class="n">pos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">;</span> <span class="n">pos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span>   

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>                                                          <span class="c1"># creating the figure and assigning the size
</span><span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">)</span>     
<span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z1</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s">"r"</span> <span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> 
<span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z2</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s">"b"</span> <span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> 
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>                                                                  <span class="c1"># making both the axis equal
</span><span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'X-Axis'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>                                                  <span class="c1"># X-Axis
</span><span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Y-Axis'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>                                                  <span class="c1"># Y-Axis
</span><span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Initial State'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>                                            <span class="c1"># Title of the plot
</span><span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>                                                                         <span class="c1"># displaying gridlines
</span><span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_9_0.png" alt="png" /></p>

<font size="4">
Denote the probability that observed $x_i$ comes from custler j by 

$$\gamma_i^j=p(z=j|x=x_i)$$

computationally 
$$\begin{aligned}
\gamma_i ^j&amp;=p(z=j|x_i) \\
&amp;= p(z=j,x_i)/p(x_i) \\
&amp;= \frac{\pi_j N(x_i|\mu_z,\Sigma_z)}{\sum_{c=1}^k(\pi_c N(x_i|\mu_z,\Sigma_z))}
\end{aligned}$$

${\sum_{c=1}^k(\pi_c N(x_i|\mu_z,\Sigma_z))}$ indicate the sum of the all possibiltiy belonged to different cluster c from 1 to k , for example in 1-D , 2clusters it could be
    
![image.png](/assets/2023-10-11-expectation-maximization-algorithm_files/3afe781f-92c7-4dca-b9ec-aacf0f57ff8b.png)

$\pi_c$ could cacluate as such 
$$\pi_c = \frac{n_c}{n} $$ let $n_c=\sum_{i=1}^n \gamma_i^c$ 
at the very begining, it could be manually assigned value (?)
</font>
<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/d2f8a6a3-4e7b-4517-ac5e-79855f98f6be.png" alt="image.png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##Expectation step
</span><span class="k">def</span> <span class="nf">Estep</span><span class="p">(</span><span class="n">lis1</span><span class="p">):</span>
    <span class="n">m1</span><span class="o">=</span><span class="n">lis1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">m2</span><span class="o">=</span><span class="n">lis1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">cov1</span><span class="o">=</span><span class="n">lis1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">cov2</span><span class="o">=</span><span class="n">lis1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">pi</span><span class="o">=</span><span class="n">lis1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    
    <span class="c1">#get the possibility for each given data under cluster 1 and 2
</span>    <span class="n">pt2</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">m2</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="n">cov2</span><span class="p">)</span> 
    <span class="n">pt1</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="n">cov1</span><span class="p">)</span>
    <span class="n">w2</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">pt2</span>  <span class="c1">##the first cluster have the pi estimate priors
</span>    <span class="n">w1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">pt1</span>  <span class="c1">##only two cluster, so another is 1-pi
</span>    <span class="n">eval2</span> <span class="o">=</span> <span class="n">w2</span><span class="o">/</span><span class="p">(</span><span class="n">w1</span><span class="o">+</span><span class="n">w2</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="n">eval2</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/6dacb150-4878-47da-bc24-3ceea8015e50.png" alt="image.png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Maximization step
</span><span class="k">def</span> <span class="nf">Mstep</span><span class="p">(</span><span class="n">eval1</span><span class="p">):</span> <span class="c1">#accutally it is the eval for the cluster 2 instead 1 
</span>    <span class="n">num_mu1</span><span class="p">,</span><span class="n">din_mu1</span><span class="p">,</span><span class="n">num_mu2</span><span class="p">,</span><span class="n">din_mu2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)):</span>
        <span class="n">num_mu1</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eval1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">din_mu1</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eval1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">num_mu2</span> <span class="o">+=</span> <span class="n">eval1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">din_mu2</span> <span class="o">+=</span> <span class="n">eval1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">mu1</span> <span class="o">=</span> <span class="n">num_mu1</span><span class="o">/</span><span class="n">din_mu1</span>  <span class="c1"># get the new mu1
</span>    <span class="n">mu2</span> <span class="o">=</span> <span class="n">num_mu2</span><span class="o">/</span><span class="n">din_mu2</span>  <span class="c1"># get the new mu2
</span>
    <span class="n">num_s1</span><span class="p">,</span><span class="n">din_s1</span><span class="p">,</span><span class="n">num_s2</span><span class="p">,</span><span class="n">din_s2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)):</span>

        <span class="n">q1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">mu1</span><span class="p">)</span>  <span class="c1"># x-mu
</span>        <span class="n">num_s1</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eval1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">q1</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span> <span class="c1"># p(c|x)*(x-mu)*(x-mu)_T
</span>        <span class="n">din_s1</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eval1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="c1">#n_c
</span>
        <span class="n">q2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">mu2</span><span class="p">)</span>
        <span class="n">num_s2</span> <span class="o">+=</span> <span class="n">eval1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">q2</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
        <span class="n">din_s2</span> <span class="o">+=</span> <span class="n">eval1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">s1</span> <span class="o">=</span> <span class="n">num_s1</span><span class="o">/</span><span class="n">din_s1</span>  <span class="c1">#normalize with n_c
</span>    <span class="n">s2</span> <span class="o">=</span> <span class="n">num_s2</span><span class="o">/</span><span class="n">din_s2</span>  <span class="c1">#normalize with n_c
</span>
    <span class="n">pi</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">eval1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># new priors 
</span>    
    <span class="n">lis2</span><span class="o">=</span><span class="p">[</span><span class="n">mu1</span><span class="p">,</span><span class="n">mu2</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">pi</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">lis2</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">lis1</span><span class="p">):</span>
    <span class="n">mu1</span><span class="o">=</span><span class="n">lis1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mu2</span><span class="o">=</span><span class="n">lis1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">s1</span><span class="o">=</span><span class="n">lis1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">s2</span><span class="o">=</span><span class="n">lis1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">Z1</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mu1</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>  
    <span class="n">Z2</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>

    <span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">empty</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="p">,))</span>                <span class="c1"># a new array of given shape and type, without initializing entries
</span>    <span class="n">pos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">;</span> <span class="n">pos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span>   

    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>                                                          <span class="c1"># creating the figure and assigning the size
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">)</span>     
    <span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z1</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s">"r"</span> <span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z2</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s">"b"</span> <span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>                                                                  <span class="c1"># making both the axis equal
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'X-Axis'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>                                                  <span class="c1"># X-Axis
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Y-Axis'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>                                                  <span class="c1"># Y-Axis
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>                                                                         <span class="c1"># displaying gridlines
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iterations</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">lis1</span><span class="o">=</span><span class="p">[</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">cov1</span><span class="p">,</span><span class="n">cov2</span><span class="p">,</span><span class="n">pi</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">iterations</span><span class="p">):</span>
    <span class="n">lis2</span> <span class="o">=</span> <span class="n">Mstep</span><span class="p">(</span><span class="n">Estep</span><span class="p">(</span><span class="n">lis1</span><span class="p">))</span>
    <span class="n">lis1</span><span class="o">=</span><span class="n">lis2</span>
    <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">9</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">19</span><span class="p">):</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">lis1</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_15_0.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_15_1.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_15_2.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_15_3.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_15_4.png" alt="png" /></p>

<h1 id="example-2">Example 2</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#import requred libraries
</span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">multivariate_normal</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">warnings</span><span class="p">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">'ignore'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Generate some data with multiple modes
</span><span class="n">data1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Plot the data using seaborn's distplot function
</span><span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">hist</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'b'</span><span class="p">,</span> <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>
<span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">hist</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span> <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>

<span class="c1"># Add a legend
</span><span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'Data 1'</span><span class="p">,</span> <span class="s">'Data 2'</span><span class="p">])</span>

<span class="c1"># Show the plot
</span><span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_18_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Set the mean and covariance 
</span><span class="n">mean1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> 
<span class="n">mean2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> 
<span class="n">cov1</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="p">.</span><span class="mi">7</span><span class="p">],</span> <span class="p">[.</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> 
<span class="n">cov2</span> <span class="o">=</span> <span class="p">[[.</span><span class="mi">5</span><span class="p">,</span> <span class="p">.</span><span class="mi">4</span><span class="p">],</span> <span class="p">[.</span><span class="mi">4</span><span class="p">,</span> <span class="p">.</span><span class="mi">5</span><span class="p">]]</span> 

<span class="c1"># Generate data from the mean and covariance 
</span><span class="n">data1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean1</span><span class="p">,</span> <span class="n">cov1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span> 
<span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean2</span><span class="p">,</span> <span class="n">cov2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> 

<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">data1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> 
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">data2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> 

<span class="n">sns</span><span class="p">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">data1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'k'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> 
<span class="n">sns</span><span class="p">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">data2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'k'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> 

<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span> 
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_20_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>                 <span class="c1"># import matplotlib.pyplot for plotting framework
</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">100</span> 
<span class="n">mu1</span><span class="p">,</span> <span class="n">sigma1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1.2</span>  
<span class="n">mu2</span><span class="p">,</span> <span class="n">sigma2</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.8</span>  
<span class="n">mu3</span><span class="p">,</span> <span class="n">sigma3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.6</span>  

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">mu1</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma1</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="n">n_samples</span><span class="p">)</span> 
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma2</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="n">n_samples</span><span class="p">)</span> 
<span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">mu3</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma3</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="n">n_samples</span><span class="p">)</span> 

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">))</span>
<span class="c1">#下面是可视化的函数封装
</span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span> 

<span class="k">def</span> <span class="nf">plot_pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s">'k--'</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">'green'</span><span class="p">):</span>
    <span class="s">"""
    Plot 1-D data and its PDF curve.

    Parameters
    ----------
    X : array-like, shape (n_samples,)
        The input data.
    """</span>
    <span class="c1"># Compute the mean and standard deviation of the data
</span>
    <span class="c1"># Plot the data
</span>    
    <span class="n">X</span> <span class="o">=</span> <span class="n">norm</span><span class="p">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

    <span class="c1"># Plot the PDF
</span>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="nb">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">.</span><span class="nb">max</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linestyle</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot_pdf</span><span class="p">(</span><span class="n">mu1</span><span class="p">,</span><span class="n">sigma1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s">"$\mu={} \ ; \ \sigma={}$"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">mu1</span><span class="p">,</span><span class="n">sigma1</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">plot_pdf</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span><span class="n">sigma2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s">"$\mu={} \ ; \ \sigma={}$"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span><span class="n">sigma2</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">plot_pdf</span><span class="p">(</span><span class="n">mu3</span><span class="p">,</span><span class="n">sigma3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s">"$\mu={} \ ; \ \sigma={}$"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">mu3</span><span class="p">,</span><span class="n">sigma3</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Original Distribution"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_22_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">random_init</span><span class="p">(</span><span class="n">n_compenents</span><span class="p">):</span> 
    <span class="s">"""Initialize means, weights and variance randomly  
      and plot the initialization 
    """</span> 
 
    <span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_compenents</span><span class="p">))</span> <span class="o">/</span> <span class="n">n_compenents</span> 
    <span class="n">means</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_compenents</span><span class="p">)</span> 
    <span class="n">variances</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">random_sample</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n_compenents</span><span class="p">)</span> 

    <span class="n">plot_pdf</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">variances</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s">'Random Init 01'</span><span class="p">)</span> 
    <span class="n">plot_pdf</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">variances</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s">'Random Init 02'</span><span class="p">)</span> 
    <span class="n">plot_pdf</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">variances</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="s">'Random Init 03'</span><span class="p">)</span> 
 
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span> 
    <span class="k">return</span> <span class="n">means</span><span class="p">,</span><span class="n">variances</span><span class="p">,</span><span class="n">pi</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">step_expectation</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">n_components</span><span class="p">,</span><span class="n">means</span><span class="p">,</span><span class="n">variances</span><span class="p">):</span> 
    <span class="s">"""E Step 
 
    Parameters 
    ---------- 
    X : array-like, shape (n_samples,) 
        The data. 
    n_components : int 
        The number of clusters 
    means : array-like, shape (n_components,) 
        The means of each mixture component. 
    variances : array-like, shape (n_components,) 
        The variances of each mixture component. 
 
    Returns 
    ------- 
    weights : array-like, shape (n_components,n_samples) 
    """</span> 
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_components</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span> 
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_components</span><span class="p">):</span> 
        <span class="n">weights</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">means</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">variances</span><span class="p">[</span><span class="n">j</span><span class="p">])).</span><span class="n">pdf</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> 
 
    <span class="k">return</span> <span class="n">weights</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">step_maximization</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">weights</span><span class="p">,</span><span class="n">means</span><span class="p">,</span><span class="n">variances</span><span class="p">,</span><span class="n">n_compenents</span><span class="p">,</span><span class="n">pi</span><span class="p">):</span> 

    <span class="s">"""M Step 
 
    Parameters 
    ---------- 
    X : array-like, shape (n_samples,) 
        The data. 
    weights : array-like, shape (n_components,n_samples) 
        initilized weights array 
    means : array-like, shape (n_components,) 
        The means of each mixture component. 
    variances : array-like, shape (n_components,) 
        The variances of each mixture component. 
    n_components : int 
        The number of clusters 
    pi: array-like (n_components,) 
        mixture component weights 
 
    Returns 
    ------- 
    means : array-like, shape (n_components,) 
        The means of each mixture component. 
    variances : array-like, shape (n_components,) 
        The variances of each mixture component. 
    """</span> 
    <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_compenents</span><span class="p">):</span>   
        <span class="n">r</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">weights</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">pi</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">([</span><span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_compenents</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)))</span> 
        <span class="c1">#5th equation above 
</span>        <span class="n">means</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span> 
        <span class="c1">#6th equation above 
</span>        <span class="n">variances</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">square</span><span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">means</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span> 
        <span class="c1">#4th equation above 
</span>        <span class="n">pi</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> 
    <span class="k">return</span> <span class="n">variances</span><span class="p">,</span><span class="n">means</span><span class="p">,</span><span class="n">pi</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">train_gmm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">n_compenents</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">n_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">plot_intermediate_steps_flag</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="s">""" Training step of the GMM model
    
    Parameters
    ----------
    data : array-like, shape (n_samples,)
        The data.
    n_components : int
        The number of clusters
    n_steps: int
        number of iterations to run
    """</span>
    
    
    <span class="n">means</span><span class="p">,</span><span class="n">variances</span><span class="p">,</span><span class="n">pi</span> <span class="o">=</span> <span class="n">random_init</span><span class="p">(</span><span class="n">n_compenents</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">step_expectation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">n_compenents</span><span class="p">,</span><span class="n">means</span><span class="p">,</span><span class="n">variances</span><span class="p">)</span>
        <span class="n">variances</span><span class="p">,</span><span class="n">means</span><span class="p">,</span><span class="n">pi</span> <span class="o">=</span> <span class="n">step_maximization</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">variances</span><span class="p">,</span> <span class="n">n_compenents</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plot_intermediate_steps_flag</span><span class="p">:</span><span class="n">plot_intermediate_steps</span><span class="p">(</span><span class="n">means</span><span class="p">,</span><span class="n">variances</span><span class="p">,)</span><span class="c1">#file_name=f'step_{step+1}')
</span>    <span class="n">plot_intermediate_steps</span><span class="p">(</span><span class="n">means</span><span class="p">,</span><span class="n">variances</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_intermediate_steps</span><span class="p">(</span><span class="n">means</span><span class="p">,</span><span class="n">variances</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">file_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    
    <span class="n">plot_pdf</span><span class="p">(</span><span class="n">mu1</span><span class="p">,</span><span class="n">sigma1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s">'r--'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">'Original Distibutions'</span><span class="p">)</span>
    <span class="n">plot_pdf</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span><span class="n">sigma2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s">'r--'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">'Original Distibutions'</span><span class="p">)</span>
    <span class="n">plot_pdf</span><span class="p">(</span><span class="n">mu3</span><span class="p">,</span><span class="n">sigma3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s">'r--'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">'Original Distibutions'</span><span class="p">)</span>
    
    <span class="n">color_gen</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'green'</span><span class="p">,</span><span class="s">'blue'</span><span class="p">,</span><span class="s">'orange'</span><span class="p">])</span>
    
    <span class="k">for</span> <span class="n">mu</span><span class="p">,</span><span class="n">sigma</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">means</span><span class="p">,</span><span class="n">variances</span><span class="p">):</span>
        <span class="n">plot_pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">'d'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">color_gen</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">save</span> <span class="ow">or</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">file_name</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"_"</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">"step: </span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s">"steps/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s">.png"</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s">'tight'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_gmm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">n_steps</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">plot_intermediate_steps_flag</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_0.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_1.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_2.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_3.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_4.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_5.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_6.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_7.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_8.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_9.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_10.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_11.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_12.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_13.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_14.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_15.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_16.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_17.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_18.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_19.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_20.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_21.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_22.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_23.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_24.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_25.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_26.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_27.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_28.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_29.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_30.png" alt="png" /></p>

<p><img src="/assets/2023-10-11-expectation-maximization-algorithm_files/2023-10-11-expectation-maximization-algorithm_28_31.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

</div>

<span class="post-tags">
    
      <i class="fa fa-tag fa-xs" aria-hidden="true"></i>
      
      <a class="no-underline" href="/tag/AI"><nobr>AI</nobr></code>&nbsp;</a>    
    
</span>

<div class="recent">
  <h2>Recent Posts</h2>
  <ul class="recent-posts">
    
      <li>
        <h4>
          <a href="/coding/2023/12/11/diffusion-model-demo2.html">
            A Diffusion Model from Scratch in Pytorch
          </a>
          <small>[11 Dec 2023]</small>
        </h4>
      </li>
    
      <li>
        <h4>
          <a href="/coding/2023/12/02/Inspect-BERT-Vocabulary.html">
            Inspect BERT Vocabulary
          </a>
          <small>[02 Dec 2023]</small>
        </h4>
      </li>
    
      <li>
        <h4>
          <a href="/working/2023/12/01/My-Tasks-and-Notes.html">
            working todo
          </a>
          <small>[01 Dec 2023]</small>
        </h4>
      </li>
    
  </ul>
</div>
    </div>

  </body>
</html>
